import{b as k,y as D,K as T,c as b,o as p,e as t,p as E,r as W,M,f as C,u as _,F as q,h as A,t as h}from"./CxVK4Cb8.js";const R={id:"waveform-canvas-container",class:"bg-green h-full w-full"},N=["width","height"],P={__name:"Waveform",props:{timeDomainBufferHistory:{type:Array},canvasWidth:{type:Number},canvasHeight:{type:Number},fillStyle:{type:String,default:"rgba(0,0,0)"},strokeStyle:{type:String,default:"rgb(255, 255, 255)"}},setup(f){const l=f;return k(()=>{const d=document.getElementById("waveformCanvas2"),e=d.getContext("2d"),s=document.getElementById("waveform-canvas-container"),c=l.canvasHeight?l.canvasHeight:s.clientHeight,o=l.canvasWidth?l.canvasWidth:s.clientWidth;d.height=c,d.width=o,e.fillRect(0,0,o,c),D(l.timeDomainBufferHistory,a=>{e.fillStyle=l.fillStyle,e.fillRect(0,0,o,c),e.lineWidth=2,e.strokeStyle=l.strokeStyle,e.beginPath();const u=a.slice(-1)[0],y=u.length,v=o/y;let g=0;for(let i=0;i<y;i++){const m=u[i]/128*c/2;i===0?e.moveTo(g,m):e.lineTo(g,m),g+=v}e.lineTo(d.width,d.height/2),e.stroke()})}),T(()=>{}),(d,e)=>(p(),b("div",R,[t("canvas",{id:"waveformCanvas2",width:f.canvasWidth,height:f.canvasHeight},null,8,N)]))}},U={id:"spectrogram-canvas-container",class:"h-full w-full"},O=["width","height"],F=36,G={__name:"Spectrogram",props:{frequencyDomainBufferHistory:{type:Array},canvasWidth:{type:Number},canvasHeight:{type:Number},fillStyle:{type:String,default:"rgba(0,0,0)"}},setup(f){const l=f,d=(e,s,c,o,a)=>(e-s)*(a-s)/(c-s)+o;return k(()=>{const e=document.getElementById("spectrogramCanvas"),s=e.getContext("2d"),c=document.getElementById("spectrogram-canvas-container"),o=l.canvasHeight?l.canvasHeight:c.clientHeight,a=l.canvasWidth?l.canvasWidth:c.clientWidth;e.height=o,e.width=a,s.fillRect(0,0,a,o),D(l.frequencyDomainBufferHistory,u=>{s.fillStyle=l.fillStyle,s.fillRect(0,0,a,o);const y=u.slice(-36),v=a/128,g=o/F;for(let i=0;i<128;i++)for(let n=0;n<F;n++){const m=y[n][i],w=d(m,0,255,1,4);s.fillStyle=`rgb(${m}, 0, ${m})`,s.beginPath(),s.arc(i*v+v/2,n*g+g/2,w,0,2*Math.PI),s.fill()}})}),(e,s)=>(p(),b("div",null,[t("div",U,[t("canvas",{id:"spectrogramCanvas",width:f.canvasWidth,height:f.canvasHeight},null,8,O)])]))}},L={id:"bar-graph-container",class:"h-full w-full"},K=["width","height"],I=2,V={__name:"FrequencyBarGraph",props:{audioBufferHistory:{type:Array},canvasWidth:{type:Number},canvasHeight:{type:Number},fillStyle:{type:String,default:"rgba(0,0,0)"},strokeStyle:{type:String,default:"rgb(255, 255, 255)"}},setup(f){const l=f,d=(e,s,c,o,a)=>(e-s)*(a-s)/(c-s)+o;return k(()=>{const e=document.getElementById("frequencyBarGraphCanvas"),s=e.getContext("2d"),c=document.getElementById("bar-graph-container"),o=l.canvasHeight?l.canvasHeight:c.clientHeight,a=l.canvasWidth?l.canvasWidth:c.clientWidth;e.height=o,e.width=a,s.fillRect(0,0,a,o),D(l.audioBufferHistory,u=>{s.fillStyle=l.fillStyle,s.fillRect(0,0,a,o);const y=u.slice(-1)[0],v=a/y.length-I;let g=0;for(let i=0;i<y.length;i++){const n=y[i],m=d(n,0,255,0,o);s.fillStyle=`rgb(${n},0,${n})`,s.fillRect(g,o-m,v,m),g+=v+I}})}),(e,s)=>(p(),b("div",null,[t("div",L,[t("canvas",{id:"frequencyBarGraphCanvas",width:f.canvasWidth,height:f.canvasHeight},null,8,K)])]))}},Y={class:"container mx-auto font-mono"},z={class:"bg-background text-white"},X={class:"grid grid-cols-3 gap-4"},Z={class:"col-span-3 rounded-xl bg-black/75 p-4 lg:col-span-1"},j={class:"col-span-3 rounded-xl bg-black/75 p-4 lg:col-span-1"},J={class:"col-span-3 rounded-xl bg-black/75 p-4 lg:col-span-1"},Q={class:"col-span-3 rounded-xl bg-black/75 p-4"},tt={class:"w-full table-fixed"},et={class:"text-left font-bold"},nt={class:"text-left"},st={class:"text-left"},lt={class:"text-left"},ot={class:"text-left"},at={class:"truncate text-right"},it={class:"col-span-3 rounded-xl bg-black/75 p-4"},ct={class:"w-full table-fixed"},rt={class:"text-left font-bold"},dt={class:"text-left"},ut={class:"text-left"},ht={class:"text-left"},ft={class:"text-left"},gt={class:"truncate text-right"},B=256,mt=E({__name:"index",setup(f){let l=null,d=null,e=null,s=null,c=null,o=W([]),a=null,u=W([]);W(!1);const y=()=>{requestAnimationFrame(y),e.getByteTimeDomainData(c),c!==null&&(o.value.push(c.slice()),o.value.length>B&&o.value.shift()),e.getByteFrequencyData(a),a!==null&&(u.value.push(a.slice()),u.value.length>B&&u.value.shift())},v=()=>{navigator.mediaDevices.getUserMedia({audio:!0}).then(i=>{l=i,d=new(window.AudioContext||window.webkitAudioContext),e=d.createAnalyser(),s=d.createMediaStreamSource(l),s.connect(e),e.fftSize=2048,c=new Uint8Array(e.frequencyBinCount),a=new Uint8Array(e.frequencyBinCount);for(let n=0;n<B;n++)o.value.push(new Uint8Array(e.frequencyBinCount));for(let n=0;n<B;n++)u.value.push(new Uint8Array(e.frequencyBinCount));y()}).catch(function(i){console.error(i)})},g=()=>{l!==null&&l.active&&l.getAudioTracks().forEach(i=>{i.stop()})};return M(()=>{console.log("disabling"),g()}),(i,n)=>{const m=P,w=G,$=V;return p(),b("div",Y,[t("div",z,[t("div",X,[t("div",{class:"col-span-3 space-x-2"},[t("div",{class:"inline-block rounded-lg bg-black px-6 py-2 text-sm font-bold uppercase text-white shadow-lg shadow-green-400/25 transition duration-150 ease-in-out hover:cursor-pointer hover:shadow-white/25",onClick:v}," Enable "),t("div",{class:"inline-block rounded-lg bg-black px-6 py-2 text-sm font-bold uppercase text-white shadow-lg shadow-red-400/25 transition duration-150 ease-in-out hover:cursor-pointer hover:shadow-white/25",onClick:g}," Disable ")]),t("div",Z,[n[0]||(n[0]=t("div",{class:"mb-2 text-xl font-bold"},"Time Domain Waveform",-1)),C(m,{timeDomainBufferHistory:_(o),strokeStyle:"rgb(255, 0, 255)",class:"h-72 border-2 border-gray-400"},null,8,["timeDomainBufferHistory"])]),t("div",j,[n[1]||(n[1]=t("div",{class:"mb-2 text-xl font-bold"},"Frequency Spectrogram",-1)),C(w,{frequencyDomainBufferHistory:_(u),class:"h-72 border-2 border-gray-400"},null,8,["frequencyDomainBufferHistory"])]),t("div",J,[n[2]||(n[2]=t("div",{class:"mb-2 text-xl font-bold"},"Frequency Bar Chart",-1)),C($,{audioBufferHistory:_(u),class:"h-72 border-2 border-gray-400"},null,8,["audioBufferHistory"])]),t("div",Q,[n[4]||(n[4]=t("div",{class:"mb-2 text-xl font-bold"},"Frequency Buffer History",-1)),t("div",null,[t("table",tt,[n[3]||(n[3]=t("thead",{class:"collapse border-b-2 md:visible"},[t("tr",null,[t("th",{class:"text-left"},"Index"),t("th",{class:"text-left"},"Mean"),t("th",{class:"text-left"},"Min"),t("th",{class:"text-left"},"Max"),t("th",{class:"text-left"},"FFT"),t("th",{class:"text-right"},"Buffer")])],-1)),t("tbody",null,[(p(!0),b(q,null,A(_(u).slice(-10),(r,x)=>(p(),b("tr",{key:x},[t("td",et,h(x),1),t("td",nt,h((r.reduce((H,S)=>H+S)/r.length).toFixed(2)),1),t("td",st,h(Math.min(...r)),1),t("td",lt,h(Math.max(...r)),1),t("td",ot,h(r.length),1),t("td",at,h(r.slice(0,4))+" ... "+h(r.slice(-4)),1)]))),128))])])])]),t("div",it,[n[6]||(n[6]=t("div",{class:"mb-2 text-xl font-bold"},"Time Domain Buffer History",-1)),t("div",null,[t("table",ct,[n[5]||(n[5]=t("thead",{class:"collapse border-b-2 md:visible"},[t("tr",null,[t("th",{class:"text-left"},"Index"),t("th",{class:"text-left"},"Mean"),t("th",{class:"text-left"},"Min"),t("th",{class:"text-left"},"Max"),t("th",{class:"text-left"},"FFT"),t("th",{class:"text-right"},"Buffer")])],-1)),t("tbody",null,[(p(!0),b(q,null,A(_(o).slice(-10),(r,x)=>(p(),b("tr",{key:x},[t("td",rt,h(x),1),t("td",dt,h((r.reduce((H,S)=>H+S)/r.length).toFixed(2)),1),t("td",ut,h(Math.min(...r)),1),t("td",ht,h(Math.max(...r)),1),t("td",ft,h(r.length),1),t("td",gt,h(r.slice(0,4))+" ... "+h(r.slice(-4)),1)]))),128))])])])])])])])}}});export{mt as default};
