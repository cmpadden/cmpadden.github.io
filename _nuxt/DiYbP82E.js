import{_ as I}from"./BXt2ASCG.js";import{_ as M}from"./BRHH9d13.js";import{_ as U}from"./B_xfC5XW.js";import{s as G,v as H,r as y,q as J,i as x,x as m,c as d,e as s,F as k,l as C,u as a,t as p,d as q,o as i,m as A,w as K,f as O,n as j,p as W}from"./BDpF0hQS.js";import{u as X}from"./CzmErGs3.js";import{q as Y}from"./BsI4mepb.js";const Z={class:"min-h-screen bg-emerald-950 bg-[url('/images/noise.svg')] py-10 text-white"},ee={class:"container space-y-8"},te={class:"space-y-4"},re={class:"grid gap-4"},se={class:"flex flex-col justify-between space-y-2 bg-black/50 p-4 text-white drop-shadow-lg hover:ring-1 hover:ring-white"},ne={class:"space-y-1"},ae={class:"flex flex-col gap-1 md:flex-row md:items-center md:gap-3"},oe={class:"text-lg font-semibold text-orange-400 md:flex-1 md:text-xl"},ie={class:"flex items-center gap-2 md:ml-auto"},le={key:0,class:"line-clamp-3 text-sm text-gray-100"},ue={class:"flex items-center justify-between text-sm text-gray-300"},ce=["disabled"],de=["disabled"],pe={class:"space-y-6 border-t border-white/20 pt-6"},ge={class:"grid gap-8 lg:grid-cols-2"},xe={class:"mt-3 flex flex-wrap gap-2"},me=["onClick"],_e={key:0},ye={class:"mt-3 flex flex-wrap gap-2"},fe=["onClick"],S=8,Se={__name:"index",async setup(ve){let _,T;const c=G(),B=H(),l=y([]),u=y([]),n=y(1),z=y(!0),{data:f}=([_,T]=J(()=>X("articles",()=>Y("content").order("date","DESC").all())),_=await _,T(),_),F=x(()=>[...new Set(f.value.map(e=>e.categories).flat().sort())]),R=x(()=>[...new Set(f.value.map(e=>e.tags).flat().sort())]),v=x(()=>f.value.filter(e=>!(l.value.length>0&&!l.value.every(r=>e.categories.includes(r))||u.value.length>0&&!u.value.every(r=>e.tags.includes(r))))),g=x(()=>Math.max(1,Math.ceil(v.value.length/S))),V=x(()=>{const e=(n.value-1)*S;return v.value.slice(e,e+S)});function D(e){if(!e?.external_url)return"";if(e?.external_site)return e.external_site;try{return new URL(e.external_url).hostname.replace(/^www\./,"")}catch{return e.external_url}}function E(e){u.value.includes(e)?u.value=u.value.filter(r=>r!==e):u.value.push(e),n.value=1}function L(e){l.value.includes(e)?l.value=l.value.filter(r=>r!==e):l.value.push(e),n.value=1}function N(e){if(!e)return[];const r=Array.isArray(e)?e:e.split(",").map(o=>o.trim());return[...new Set(r.filter(Boolean))]}function P(e){return e?Array.isArray(e)?e.join(","):e:""}function Q(e){if(!e)return 1;const r=Array.isArray(e)?e[0]:e,o=parseInt(r,10);return Number.isFinite(o)&&o>0?o:1}return m(()=>c.query.category,e=>{l.value=N(e)},{immediate:!0}),m(()=>c.query.tag,e=>{u.value=N(e)},{immediate:!0}),m(()=>c.query.page,e=>{n.value=Q(e)},{immediate:!0}),m(v,()=>{n.value>g.value&&(n.value=g.value)}),m([l,u,n],()=>{const e=l.value.join(","),r=u.value.join(","),o=n.value>1?String(n.value):"",h=P(c.query.category),b=P(c.query.tag),w=Array.isArray(c.query.page)?c.query.page[0]:c.query.page||"";if(e===h&&r===b&&o===w)return;const t={...c.query};e?t.category=e:delete t.category,r?t.tag=r:delete t.tag,o?t.page=o:delete t.page,B.replace({query:t})},{deep:!0}),(e,r)=>{const o=I,h=M,b=U,w=W;return i(),d("section",Z,[s("div",ee,[s("div",te,[s("div",re,[(i(!0),d(k,null,C(a(V),t=>(i(),A(w,{key:t._id,to:t.path,class:"h-full"},{default:K(()=>[s("div",se,[s("div",ne,[s("div",ae,[s("p",oe,p(t.title),1),s("div",ie,[t.external_url?(i(),A(o,{key:0,site:D(t)},null,8,["site"])):q("",!0)])]),O(h,{datetime:t.date,class:"text-xs text-gray-300",year:"numeric",month:"short",day:"2-digit"},null,8,["datetime"])]),t.description?(i(),d("p",le,p(t.description),1)):t.meta?.excerpt?(i(),A(b,{key:1,value:t.meta.excerpt,class:"line-clamp-4 text-sm text-gray-100"},null,8,["value"])):q("",!0)])]),_:2},1032,["to"]))),128))]),s("div",ue,[s("button",{type:"button",class:"border border-white/20 px-3 py-1 text-xs uppercase tracking-wide transition hover:border-orange-400 hover:text-white disabled:cursor-not-allowed disabled:border-white/5 disabled:text-gray-500",disabled:a(n)===1,onClick:r[0]||(r[0]=t=>a(n)>1&&n.value--)}," Previous ",8,ce),s("p",null,"Page "+p(a(n))+" of "+p(a(g)),1),s("button",{type:"button",class:"border border-white/20 px-3 py-1 text-xs uppercase tracking-wide transition hover:border-orange-400 hover:text-white disabled:cursor-not-allowed disabled:border-white/5 disabled:text-gray-500",disabled:a(n)===a(g),onClick:r[1]||(r[1]=t=>a(n)<a(g)&&n.value++)}," Next ",8,de)])]),s("div",pe,[s("div",ge,[s("div",null,[r[2]||(r[2]=s("p",{class:"text-xs uppercase tracking-widest text-gray-300"}," Categories ",-1)),s("div",xe,[(i(!0),d(k,null,C(a(F),t=>(i(),d("button",{key:t,type:"button",class:j(["border border-white/20 px-4 py-1 text-sm transition hover:border-orange-400 hover:text-white",a(l).includes(t)?"bg-orange-500 text-white":"text-gray-200"]),onClick:$=>L(t)},p(t),11,me))),128))])]),a(z)?(i(),d("div",_e,[r[3]||(r[3]=s("p",{class:"text-xs uppercase tracking-widest text-gray-300"},"Tags",-1)),s("div",ye,[(i(!0),d(k,null,C(a(R),(t,$)=>(i(),d("button",{key:$,type:"button",class:j(["border border-white/20 px-4 py-1 text-sm transition hover:border-orange-400 hover:text-white",a(u).includes(t)?"bg-orange-500 text-white":"text-gray-200"]),onClick:he=>E(t)},p(t),11,fe))),128))])])):q("",!0)])])])])}}};export{Se as default};
