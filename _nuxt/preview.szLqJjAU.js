import{k as C,a7 as k,a8 as S,q as j,a9 as A,a6 as O,L as I,u as g}from"./entry.DRhb1syT.js";import{i as P}from"./index.DvDH6DOc.js";const d=/^[\u0009\u0020-\u007E\u0080-\u00FF]+$/;function D(e,r){if(typeof e!="string")throw new TypeError("argument str must be a string");const o={},a=(r||{}).decode||N;let s=0;for(;s<e.length;){const i=e.indexOf("=",s);if(i===-1)break;let n=e.indexOf(";",s);if(n===-1)n=e.length;else if(n<i){s=e.lastIndexOf(";",i-1)+1;continue}const f=e.slice(s,i).trim();if(o[f]===void 0){let c=e.slice(i+1,n).trim();c.codePointAt(0)===34&&(c=c.slice(1,-1)),o[f]=x(c,a)}s=n+1}return o}function h(e,r,o){const t=o||{},a=t.encode||M;if(typeof a!="function")throw new TypeError("option encode is invalid");if(!d.test(e))throw new TypeError("argument name is invalid");const s=a(r);if(s&&!d.test(s))throw new TypeError("argument val is invalid");let i=e+"="+s;if(t.maxAge!==void 0&&t.maxAge!==null){const n=t.maxAge-0;if(Number.isNaN(n)||!Number.isFinite(n))throw new TypeError("option maxAge is invalid");i+="; Max-Age="+Math.floor(n)}if(t.domain){if(!d.test(t.domain))throw new TypeError("option domain is invalid");i+="; Domain="+t.domain}if(t.path){if(!d.test(t.path))throw new TypeError("option path is invalid");i+="; Path="+t.path}if(t.expires){if(!R(t.expires)||Number.isNaN(t.expires.valueOf()))throw new TypeError("option expires is invalid");i+="; Expires="+t.expires.toUTCString()}if(t.httpOnly&&(i+="; HttpOnly"),t.secure&&(i+="; Secure"),t.priority)switch(typeof t.priority=="string"?t.priority.toLowerCase():t.priority){case"low":i+="; Priority=Low";break;case"medium":i+="; Priority=Medium";break;case"high":i+="; Priority=High";break;default:throw new TypeError("option priority is invalid")}if(t.sameSite)switch(typeof t.sameSite=="string"?t.sameSite.toLowerCase():t.sameSite){case!0:i+="; SameSite=Strict";break;case"lax":i+="; SameSite=Lax";break;case"strict":i+="; SameSite=Strict";break;case"none":i+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return i}function R(e){return Object.prototype.toString.call(e)==="[object Date]"||e instanceof Date}function x(e,r){try{return r(e)}catch{return e}}function N(e){return e.includes("%")?decodeURIComponent(e):e}function M(e){return encodeURIComponent(e)}function u(e){if(typeof e!="object")return e;var r,o,t=Object.prototype.toString.call(e);if(t==="[object Object]"){if(e.constructor!==Object&&typeof e.constructor=="function"){o=new e.constructor;for(r in e)e.hasOwnProperty(r)&&o[r]!==e[r]&&(o[r]=u(e[r]))}else{o={};for(r in e)r==="__proto__"?Object.defineProperty(o,r,{value:u(e[r]),configurable:!0,enumerable:!0,writable:!0}):o[r]=u(e[r])}return o}if(t==="[object Array]"){for(r=e.length,o=Array(r);r--;)o[r]=u(e[r]);return o}return t==="[object Set]"?(o=new Set,e.forEach(function(a){o.add(u(a))}),o):t==="[object Map]"?(o=new Map,e.forEach(function(a,s){o.set(u(s),u(a))}),o):t==="[object Date]"?new Date(+e):t==="[object RegExp]"?(o=new RegExp(e.source,e.flags),o.lastIndex=e.lastIndex,o):t==="[object DataView]"?new e.constructor(u(e.buffer)):t==="[object ArrayBuffer]"?e.slice(0):t.slice(-6)==="Array]"?new e.constructor(e):e}const L={path:"/",watch:!0,decode:e=>O(decodeURIComponent(e)),encode:e=>encodeURIComponent(typeof e=="string"?e:JSON.stringify(e))};function m(e,r){var f;const o={...L,...r},t=v(o)||{};let a;o.maxAge!==void 0?a=o.maxAge*1e3:o.expires&&(a=o.expires.getTime()-Date.now());const s=a!==void 0&&a<=0,i=u(s?void 0:t[e]??((f=o.default)==null?void 0:f.call(o))),n=a&&!s?_(i,a):C(i);{const c=typeof BroadcastChannel>"u"?null:new BroadcastChannel(`nuxt:cookies:${e}`),w=()=>{o.readonly||P(n.value,t[e])||(U(e,n.value,o),t[e]=u(n.value),c==null||c.postMessage({value:o.encode(n.value)}))},T=p=>{var y;const E=p.refresh?(y=v(o))==null?void 0:y[e]:o.decode(p.value);l=!0,t[e]=n.value=E,I(()=>{l=!1})};let l=!1;k()&&S(()=>{l=!0,w(),c==null||c.close()}),c&&(c.onmessage=({data:p})=>T(p)),o.watch?j(n,()=>{l||w()},{deep:o.watch!=="shallow"}):w()}return n}function v(e={}){return D(document.cookie,e)}function q(e,r,o={}){return r==null?h(e,r,{...o,maxAge:-1}):h(e,r,o)}function U(e,r,o={}){document.cookie=q(e,r,o)}const b=2147483647;function _(e,r){let o,t=0;return k()&&S(()=>{clearTimeout(o)}),A((a,s)=>{function i(){clearTimeout(o);const n=r-t,f=n<b?n:b;o=setTimeout(()=>{if(t+=f,t<r)return i();e=void 0,s()},f)}return{get(){return a(),e},set(n){i(),e=n,s()}}})}const V=()=>({isEnabled:()=>{const t=g().query;return Object.prototype.hasOwnProperty.call(t,"preview")&&!t.preview?!1:!!(t.preview||m("previewToken").value||sessionStorage.getItem("previewToken"))},getPreviewToken:()=>m("previewToken").value||sessionStorage.getItem("previewToken")||void 0,setPreviewToken:t=>{m("previewToken").value=t,g().query.preview=t||"",t?sessionStorage.setItem("previewToken",t):sessionStorage.removeItem("previewToken"),window.location.reload()}});export{V as u};
