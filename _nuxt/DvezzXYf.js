import{_ as E}from"./ZKIsFPZD.js";import{_ as M}from"./Bl-xL4gn.js";import{s as I,v as U,r as v,q as G,i as m,x as _,c as p,e as s,F as k,l as C,u as a,t as g,d as q,o as i,m as P,w as H,f as J,n as j,p as K}from"./BzE8NJvd.js";import{u as O}from"./DNGNBkY6.js";import{q as W}from"./CLzVZttS.js";const X={class:"min-h-screen bg-emerald-950 bg-[url('/images/noise.svg')] py-10 text-white"},Y={class:"container mx-auto space-y-8"},Z={class:"space-y-4"},ee={class:"grid gap-4"},te={class:"flex flex-col justify-between space-y-3 bg-black/50 p-4 text-white drop-shadow-lg hover:ring-1 hover:ring-white"},re={class:"space-y-1"},se={class:"flex flex-col gap-1 md:flex-row md:items-center md:gap-3"},ne={class:"text-lg font-semibold text-orange-400 md:flex-1 md:text-xl"},ae={class:"flex items-center gap-2 md:ml-auto"},oe={key:0,class:"rounded border border-orange-500/30 bg-orange-500/20 px-2 py-0.5 text-[10px] uppercase tracking-wide text-orange-300"},ie={key:0,class:"line-clamp-3 text-sm text-gray-100"},le={class:"flex items-center justify-between text-sm text-gray-300"},ue=["disabled"],ce=["disabled"],de={class:"space-y-6 border-t border-white/20 pt-6"},pe={class:"grid gap-8 lg:grid-cols-2"},ge={class:"mt-3 flex flex-wrap gap-2"},xe=["onClick"],me={key:0},_e={class:"mt-3 flex flex-wrap gap-2"},ye=["onClick"],A=8,qe={__name:"index",async setup(ve){let y,S;const d=I(),B=U(),l=v([]),u=v([]),n=v(1),$=v(!0),{data:h}=([y,S]=G(()=>O("articles",()=>W("content").order("date","DESC").all())),y=await y,S(),y),z=m(()=>[...new Set(h.value.map(e=>e.categories).flat().sort())]),F=m(()=>[...new Set(h.value.map(e=>e.tags).flat().sort())]),f=m(()=>h.value.filter(e=>!(l.value.length>0&&!l.value.every(t=>e.categories.includes(t))||u.value.length>0&&!u.value.every(t=>e.tags.includes(t))))),x=m(()=>Math.max(1,Math.ceil(f.value.length/A))),R=m(()=>{const e=(n.value-1)*A;return f.value.slice(e,e+A)});function V(e){if(!e?.external_url)return"";if(e?.external_site)return e.external_site;try{return new URL(e.external_url).hostname.replace(/^www\./,"")}catch{return e.external_url}}function D(e){u.value.includes(e)?u.value=u.value.filter(t=>t!==e):u.value.push(e),n.value=1}function L(e){l.value.includes(e)?l.value=l.value.filter(t=>t!==e):l.value.push(e),n.value=1}function T(e){if(!e)return[];const t=Array.isArray(e)?e:e.split(",").map(o=>o.trim());return[...new Set(t.filter(Boolean))]}function N(e){return e?Array.isArray(e)?e.join(","):e:""}function Q(e){if(!e)return 1;const t=Array.isArray(e)?e[0]:e,o=parseInt(t,10);return Number.isFinite(o)&&o>0?o:1}return _(()=>d.query.category,e=>{l.value=T(e)},{immediate:!0}),_(()=>d.query.tag,e=>{u.value=T(e)},{immediate:!0}),_(()=>d.query.page,e=>{n.value=Q(e)},{immediate:!0}),_(f,()=>{n.value>x.value&&(n.value=x.value)}),_([l,u,n],()=>{const e=l.value.join(","),t=u.value.join(","),o=n.value>1?String(n.value):"",b=N(d.query.category),w=N(d.query.tag),r=Array.isArray(d.query.page)?d.query.page[0]:d.query.page||"";if(e===b&&t===w&&o===r)return;const c={...d.query};e?c.category=e:delete c.category,t?c.tag=t:delete c.tag,o?c.page=o:delete c.page,B.replace({query:c})},{deep:!0}),(e,t)=>{const o=E,b=M,w=K;return i(),p("section",X,[s("div",Y,[s("div",Z,[s("div",ee,[(i(!0),p(k,null,C(a(R),r=>(i(),P(w,{key:r._id,to:r.path,class:"h-full"},{default:H(()=>[s("div",te,[s("div",re,[s("div",se,[s("p",ne,g(r.title),1),s("div",ae,[r.external_url?(i(),p("span",oe,g(V(r)),1)):q("",!0),J(o,{datetime:r.date,class:"text-sm text-gray-300 md:text-right",year:"numeric",month:"short",day:"2-digit"},null,8,["datetime"])])])]),r.description?(i(),p("p",ie,g(r.description),1)):r.meta?.excerpt?(i(),P(b,{key:1,value:r.meta.excerpt,class:"line-clamp-4 text-sm text-gray-100"},null,8,["value"])):q("",!0)])]),_:2},1032,["to"]))),128))]),s("div",le,[s("button",{type:"button",class:"border border-white/20 px-3 py-1 text-xs uppercase tracking-wide transition hover:border-orange-400 hover:text-white disabled:cursor-not-allowed disabled:border-white/5 disabled:text-gray-500",disabled:a(n)===1,onClick:t[0]||(t[0]=r=>a(n)>1&&n.value--)}," Previous ",8,ue),s("p",null,"Page "+g(a(n))+" of "+g(a(x)),1),s("button",{type:"button",class:"border border-white/20 px-3 py-1 text-xs uppercase tracking-wide transition hover:border-orange-400 hover:text-white disabled:cursor-not-allowed disabled:border-white/5 disabled:text-gray-500",disabled:a(n)===a(x),onClick:t[1]||(t[1]=r=>a(n)<a(x)&&n.value++)}," Next ",8,ce)])]),s("div",de,[s("div",pe,[s("div",null,[t[2]||(t[2]=s("p",{class:"text-xs uppercase tracking-widest text-gray-300"}," Categories ",-1)),s("div",ge,[(i(!0),p(k,null,C(a(z),r=>(i(),p("button",{key:r,type:"button",class:j(["border border-white/20 px-4 py-1 text-sm transition hover:border-orange-400 hover:text-white",a(l).includes(r)?"bg-orange-500 text-white":"text-gray-200"]),onClick:c=>L(r)},g(r),11,xe))),128))])]),a($)?(i(),p("div",me,[t[3]||(t[3]=s("p",{class:"text-xs uppercase tracking-widest text-gray-300"},"Tags",-1)),s("div",_e,[(i(!0),p(k,null,C(a(F),(r,c)=>(i(),p("button",{key:c,type:"button",class:j(["border border-white/20 px-4 py-1 text-sm transition hover:border-orange-400 hover:text-white",a(u).includes(r)?"bg-orange-500 text-white":"text-gray-200"]),onClick:he=>D(r)},g(r),11,ye))),128))])])):q("",!0)])])])])}}};export{qe as default};
