import{m as q,q as D,s as T,o as y,c as p,b as t,d as E,j as W,v as R,f as C,a as x,F as A,r as F,t as u}from"./entry.Db1Xfaco.js";const M={id:"waveform-canvas-container",class:"bg-green h-full w-full"},N=["width","height"],P={__name:"Waveform",props:{timeDomainBufferHistory:{type:Array},canvasWidth:{type:Number},canvasHeight:{type:Number},fillStyle:{type:String,default:"rgba(0,0,0)"},strokeStyle:{type:String,default:"rgb(255, 255, 255)"}},setup(f){const s=f;return q(()=>{const d=document.getElementById("waveformCanvas2"),e=d.getContext("2d"),n=document.getElementById("waveform-canvas-container"),i=s.canvasHeight?s.canvasHeight:n.clientHeight,o=s.canvasWidth?s.canvasWidth:n.clientWidth;d.height=i,d.width=o,e.fillRect(0,0,o,i),D(s.timeDomainBufferHistory,a=>{e.fillStyle=s.fillStyle,e.fillRect(0,0,o,i),e.lineWidth=2,e.strokeStyle=s.strokeStyle,e.beginPath();const h=a.slice(-1)[0],_=h.length,v=o/_;let g=0;for(let l=0;l<_;l++){const m=h[l]/128*i/2;l===0?e.moveTo(g,m):e.lineTo(g,m),g+=v}e.lineTo(d.width,d.height/2),e.stroke()})}),T(()=>{}),(d,e)=>(y(),p("div",M,[t("canvas",{id:"waveformCanvas2",width:f.canvasWidth,height:f.canvasHeight},null,8,N)]))}},U=P,O={id:"spectrogram-canvas-container",class:"h-full w-full"},G=["width","height"],k=36,L={__name:"Spectrogram",props:{frequencyDomainBufferHistory:{type:Array},canvasWidth:{type:Number},canvasHeight:{type:Number},fillStyle:{type:String,default:"rgba(0,0,0)"}},setup(f){const s=f,d=(e,n,i,o,a)=>(e-n)*(a-n)/(i-n)+o;return q(()=>{const e=document.getElementById("spectrogramCanvas"),n=e.getContext("2d"),i=document.getElementById("spectrogram-canvas-container"),o=s.canvasHeight?s.canvasHeight:i.clientHeight,a=s.canvasWidth?s.canvasWidth:i.clientWidth;e.height=o,e.width=a,n.fillRect(0,0,a,o),D(s.frequencyDomainBufferHistory,h=>{n.fillStyle=s.fillStyle,n.fillRect(0,0,a,o);const _=h.slice(-k),v=a/128,g=o/k;for(let l=0;l<128;l++)for(let c=0;c<k;c++){const m=_[c][l],w=d(m,0,255,1,4);n.fillStyle=`rgb(${m}, 0, ${m})`,n.beginPath(),n.arc(l*v+v/2,c*g+g/2,w,0,2*Math.PI),n.fill()}})}),(e,n)=>(y(),p("div",null,[t("div",O,[t("canvas",{id:"spectrogramCanvas",width:f.canvasWidth,height:f.canvasHeight},null,8,G)])]))}},V=L,Y={id:"bar-graph-container",class:"h-full w-full"},j=["width","height"],I=2,z={__name:"FrequencyBarGraph",props:{audioBufferHistory:{type:Array},canvasWidth:{type:Number},canvasHeight:{type:Number},fillStyle:{type:String,default:"rgba(0,0,0)"},strokeStyle:{type:String,default:"rgb(255, 255, 255)"}},setup(f){const s=f,d=(e,n,i,o,a)=>(e-n)*(a-n)/(i-n)+o;return q(()=>{const e=document.getElementById("frequencyBarGraphCanvas"),n=e.getContext("2d"),i=document.getElementById("bar-graph-container"),o=s.canvasHeight?s.canvasHeight:i.clientHeight,a=s.canvasWidth?s.canvasWidth:i.clientWidth;e.height=o,e.width=a,n.fillRect(0,0,a,o),D(s.audioBufferHistory,h=>{n.fillStyle=s.fillStyle,n.fillRect(0,0,a,o);const _=h.slice(-1)[0],v=a/_.length-I;let g=0;for(let l=0;l<_.length;l++){const c=_[l],m=d(c,0,255,0,o);n.fillStyle=`rgb(${c},0,${c})`,n.fillRect(g,o-m,v,m),g+=v+I}})}),(e,n)=>(y(),p("div",null,[t("div",Y,[t("canvas",{id:"frequencyBarGraphCanvas",width:f.canvasWidth,height:f.canvasHeight},null,8,j)])]))}},K=z,X={class:"container mx-auto font-mono"},Z={class:"bg-background text-white"},J={class:"grid grid-cols-3 gap-4"},Q={class:"col-span-3 rounded-xl bg-black/75 p-4 lg:col-span-1"},tt=t("div",{class:"mb-2 text-xl font-bold"},"Time Domain Waveform",-1),et={class:"col-span-3 rounded-xl bg-black/75 p-4 lg:col-span-1"},nt=t("div",{class:"mb-2 text-xl font-bold"},"Frequency Spectrogram",-1),st={class:"col-span-3 rounded-xl bg-black/75 p-4 lg:col-span-1"},ot=t("div",{class:"mb-2 text-xl font-bold"},"Frequency Bar Chart",-1),at={class:"col-span-3 rounded-xl bg-black/75 p-4"},lt=t("div",{class:"mb-2 text-xl font-bold"},"Frequency Buffer History",-1),it={class:"w-full table-fixed"},ct=t("thead",{class:"collapse border-b-2 md:visible"},[t("tr",null,[t("th",{class:"text-left"},"Index"),t("th",{class:"text-left"},"Mean"),t("th",{class:"text-left"},"Min"),t("th",{class:"text-left"},"Max"),t("th",{class:"text-left"},"FFT"),t("th",{class:"text-right"},"Buffer")])],-1),rt={class:"text-left font-bold"},dt={class:"text-left"},ht={class:"text-left"},ut={class:"text-left"},ft={class:"text-left"},gt={class:"truncate text-right"},_t={class:"col-span-3 rounded-xl bg-black/75 p-4"},mt=t("div",{class:"mb-2 text-xl font-bold"},"Time Domain Buffer History",-1),vt={class:"w-full table-fixed"},yt=t("thead",{class:"collapse border-b-2 md:visible"},[t("tr",null,[t("th",{class:"text-left"},"Index"),t("th",{class:"text-left"},"Mean"),t("th",{class:"text-left"},"Min"),t("th",{class:"text-left"},"Max"),t("th",{class:"text-left"},"FFT"),t("th",{class:"text-right"},"Buffer")])],-1),pt={class:"text-left font-bold"},bt={class:"text-left"},xt={class:"text-left"},Bt={class:"text-left"},wt={class:"text-left"},Ht={class:"truncate text-right"},B=256,Wt=E({__name:"index",setup(f){let s=null,d=null,e=null,n=null,i=null,o=W([]),a=null,h=W([]);W(!1);const _=()=>{requestAnimationFrame(_),e.getByteTimeDomainData(i),i!==null&&(o.value.push(i.slice()),o.value.length>B&&o.value.shift()),e.getByteFrequencyData(a),a!==null&&(h.value.push(a.slice()),h.value.length>B&&h.value.shift())},v=()=>{navigator.mediaDevices.getUserMedia({audio:!0}).then(l=>{s=l,d=new(window.AudioContext||window.webkitAudioContext),e=d.createAnalyser(),n=d.createMediaStreamSource(s),n.connect(e),e.fftSize=2048,i=new Uint8Array(e.frequencyBinCount),a=new Uint8Array(e.frequencyBinCount);for(let c=0;c<B;c++)o.value.push(new Uint8Array(e.frequencyBinCount));for(let c=0;c<B;c++)h.value.push(new Uint8Array(e.frequencyBinCount));_()}).catch(function(l){console.error(l)})},g=()=>{s!==null&&s.active&&s.getAudioTracks().forEach(l=>{l.stop()})};return R(()=>{console.log("disabling"),g()}),(l,c)=>{const m=U,w=V,$=K;return y(),p("div",X,[t("div",Z,[t("div",J,[t("div",{class:"col-span-3 space-x-2"},[t("div",{class:"inline-block rounded-lg bg-black px-6 py-2 text-sm font-bold uppercase text-white shadow-lg shadow-green-400/25 transition duration-150 ease-in-out hover:cursor-pointer hover:shadow-white/25",onClick:v}," Enable "),t("div",{class:"inline-block rounded-lg bg-black px-6 py-2 text-sm font-bold uppercase text-white shadow-lg shadow-red-400/25 transition duration-150 ease-in-out hover:cursor-pointer hover:shadow-white/25",onClick:g}," Disable ")]),t("div",Q,[tt,C(m,{timeDomainBufferHistory:x(o),strokeStyle:"rgb(255, 0, 255)",class:"h-72 border-2 border-gray-400"},null,8,["timeDomainBufferHistory"])]),t("div",et,[nt,C(w,{frequencyDomainBufferHistory:x(h),class:"h-72 border-2 border-gray-400"},null,8,["frequencyDomainBufferHistory"])]),t("div",st,[ot,C($,{audioBufferHistory:x(h),class:"h-72 border-2 border-gray-400"},null,8,["audioBufferHistory"])]),t("div",at,[lt,t("div",null,[t("table",it,[ct,t("tbody",null,[(y(!0),p(A,null,F(x(h).slice(-10),(r,b)=>(y(),p("tr",{key:b},[t("td",rt,u(b),1),t("td",dt,u((r.reduce((H,S)=>H+S)/r.length).toFixed(2)),1),t("td",ht,u(Math.min(...r)),1),t("td",ut,u(Math.max(...r)),1),t("td",ft,u(r.length),1),t("td",gt,u(r.slice(0,4))+" ... "+u(r.slice(-4)),1)]))),128))])])])]),t("div",_t,[mt,t("div",null,[t("table",vt,[yt,t("tbody",null,[(y(!0),p(A,null,F(x(o).slice(-10),(r,b)=>(y(),p("tr",{key:b},[t("td",pt,u(b),1),t("td",bt,u((r.reduce((H,S)=>H+S)/r.length).toFixed(2)),1),t("td",xt,u(Math.min(...r)),1),t("td",Bt,u(Math.max(...r)),1),t("td",wt,u(r.length),1),t("td",Ht,u(r.slice(0,4))+" ... "+u(r.slice(-4)),1)]))),128))])])])])])])])}}});export{Wt as default};
