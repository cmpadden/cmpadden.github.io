<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Colton Padden&#x27;s: Blog &amp; Experiments</title><style>pre code .line{min-height:.25rem!important}</style><style>pre code .line{display:block}</style><link rel="stylesheet" href="/_nuxt/entry.CnkH9ySR.css" crossorigin><link rel="preload" as="fetch" crossorigin="anonymous" href="/blog/fennel-initial-exploration/_payload.json?6229f6a7-f2d1-47ee-878b-0340ca0bb70a"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/BeIeZOO_.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/DwPJh3MK.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/Dxxmcacs.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/D7mAQuRI.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/BWYrAZ0M.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/C4686lLf.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/MLtWAxGS.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/BAx3eP-l.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/BDJWl4qV.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/Bmym2h9_.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/CEmpqXkA.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/Cb07YJlD.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/BR7Bqurm.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/MCitCA5V.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/CEwBVtyU.js"><link rel="preload" as="fetch" fetchpriority="low" crossorigin="anonymous" href="/_nuxt/builds/meta/6229f6a7-f2d1-47ee-878b-0340ca0bb70a.json"><meta name="description" content="The blog, portfolio, and repository of experiments by Colton Padden."><meta property="og:title" content="Colton Padden's: Blog & Experiments"><meta property="og:description" content="The blog, portfolio, and repository of experiments by Colton Padden."><meta property="og:image" content="/images/og-index.webp"><meta property="og:image:type" content="image/webp"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="/images/og-index.webp"><meta name="twitter:title" content="Colton Padden's: Blog & Experiments"><meta name="twitter:description" content="The blog, portfolio, and repository of experiments by Colton Padden."><script type="module" src="/_nuxt/BeIeZOO_.js" crossorigin></script></head><body  class="bg-background"><div id="__nuxt"><div class="bg-gradient-to-b from-orange-500 to-red-500"><div class="p-[8px]"><main class="flex h-[calc(100vh-16px)] flex-col bg-background font-display"><nav class="container mx-auto py-5"><div class="flex items-center text-gray-700 dark:text-gray-200"><div class="flex-1"></div><div class="flex items-center space-x-2"><div data-headlessui-state class="relative z-50 inline-block text-left"><div><button id="headlessui-menu-button-v-0-0" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state class="transform text-gray-700 transition-all duration-300 ease-in-out hover:scale-110 hover:text-orange-500 active:scale-95 dark:text-white"><div class="text-2xl">•••</div></button></div><!----></div></div></div></nav><main class="no-scrollbar flex-1 overflow-scroll"><!--[--><div class="container mx-auto mb-10 max-w-[1024px] space-y-6 text-white shadow-lg"><div class="flex"><!----><h1 class="text-2xl font-bold md:text-3xl">Impressions of Fennel with Hammerspoon</h1></div><div class=""><div class="flex-row space-x-0 md:flex md:space-x-2"><time data-year="numeric" data-month="short" data-day="2-digit" datetime="2023-10-22T00:00:00.000Z" class="text-xs uppercase text-gray-400" data-prehydrate-id=":WFaGyVfuXU:">Oct 22, 2023</time><div><div class="flex flex-row space-x-2 uppercase"><div class="text-xs uppercase text-gray-400">Categories</div><!--[--><a href="/blog?category=lisp" class="w-min rounded-md bg-background text-xs font-bold uppercase hover:cursor-pointer hover:text-orange-500">lisp</a><!--]--></div></div><div><div class="flex flex-row space-x-2 text-xs uppercase"><div class="text-xs uppercase text-gray-400">Tags</div><!--[--><a href="/blog?tag=lisp" class="w-min rounded-md bg-background font-bold hover:cursor-pointer hover:text-orange-500">lisp</a><a href="/blog?tag=hammerspoon" class="w-min rounded-md bg-background font-bold hover:cursor-pointer hover:text-orange-500">hammerspoon</a><a href="/blog?tag=fennel" class="w-min rounded-md bg-background font-bold hover:cursor-pointer hover:text-orange-500">fennel</a><!--]--></div></div></div></div><article class="prose max-w-[1024px] text-gray-300 prose-h2:mt-8 prose-a:font-bold prose-a:text-orange-300 prose-a:no-underline hover:prose-a:text-orange-500 prose-blockquote:text-gray-400 prose-code:text-white prose-pre:bg-orange-950/50 prose-li:my-0"><div><p><!--[-->A while back I read an introductory book on Lisp programming titled, &quot;The Little
Schemer&quot;. This book opened my mind to new (to me) programming paradigms, and left me
with a strong desire to find a way to incorporate Lisp programming into my every day
life. It took some time, but I believe I&#39;ve found what I&#39;ve been looking for: Fennel.<!--]--></p><p><!--[-->The <a href="https://fennel-lang.org/" rel="nofollow"><!--[-->Fennel<!--]--></a> programming language is a dialect of Lisp that boasts compatibility with
Lua, and it just so happens that two of my favorite applications are configured with
exactly that language: <a href="https://www.hammerspoon.org/" rel="nofollow"><!--[-->Hammerspoon<!--]--></a>, and <a href="https://neovim.io/" rel="nofollow"><!--[-->Neovim<!--]--></a>.<!--]--></p><h2 id="initial-observations"><a href="#initial-observations"><!--[-->Initial Observations<!--]--></a></h2><p><!--[-->To initially explore Fennel, I wanted to start small. My Hammerspoon configuration
consists of 7 <a href="https://github.com/cmpadden/dotfiles/tree/795749fa17e1310bb001bb7deaa22be8689f0027/hammerspoon/.hammerspoon/modules" rel="nofollow"><!--[-->modules<!--]--></a> that I use for operations such as: launching applications,
managing windows, keeping my computer from going to sleep, and general operating system
automation. So the plan is to translate these modules into Fennel, while maintaining
without breaking the existing functionality. However, at this point, I wasn&#39;t even sure
how to embed Fennel into my project...<!--]--></p><h2 id="integrating-fennel-with-hammerspoon"><a href="#integrating-fennel-with-hammerspoon"><!--[-->Integrating Fennel with Hammerspoon<!--]--></a></h2><p><!--[-->While official documentation exists describing how to <a href="https://fennel-lang.org/setup#embedding-fennel" rel="nofollow"><!--[-->embed fennel<!--]--></a> into your
project; it didn&#39;t provide me with enough clarity to know my next steps on integrating
it with Hammerspoon. I found a few resources online demonstrating how to extend the
<code><!--[-->package.path<!--]--></code> and <code><!--[-->package.cpath<!--]--></code> properties in Lua, but I was unable to get this to
work.<!--]--></p><ul><!--[--><li><!--[--><a href="https://blog.exupero.org/hammerspoon-with-fennel/" rel="nofollow"><!--[-->https://blog.exupero.org/hammerspoon-with-fennel/<!--]--></a><!--]--></li><li><!--[--><a href="https://github.com/Hammerspoon/hammerspoon/issues/2377#issuecomment-636331435" rel="nofollow"><!--[-->https://github.com/Hammerspoon/hammerspoon/issues/2377#issuecomment-636331435<!--]--></a><!--]--></li><li><!--[--><a href="https://github.com/agzam/spacehammer/blob/master/init.lua" rel="nofollow"><!--[-->https://github.com/agzam/spacehammer/blob/master/init.lua<!--]--></a><!--]--></li><!--]--></ul><p><!--[-->Ultimately, I opted to include the <code><!--[-->fennel.lua<!--]--></code> file to my Hammerspoon configuration,
and while not ideal, it does make the configuration nicely self-contained. I&#39;ll leave it
as a future task to include the module installed with LuaRocks.<!--]--></p><p><!--[-->With Fennel now included in my Hammerspoon configuration, all I need to do is configure
the <code><!--[-->fennel.path<!--]--></code> to point to the <code><!--[-->*.fnl<!--]--></code> files in the <code><!--[-->.hammerspoon/<!--]--></code> directory, and
ttranslating these modules can begin!<!--]--></p><pre class="language-lua shiki shiki-themes github-dark" style=""><!--[--><code><span class="line" line="1"><span class="sAwPA">-- init.lua
</span></span><span class="line" line="2"><span emptylineplaceholder="true">
</span></span><span class="line" line="3"><span class="snl16">local</span><span class="s95oV"> fennel </span><span class="snl16">=</span><span class="sDLfK"> require</span><span class="s95oV">(</span><span class="sU2Wk">&#39;fennel&#39;</span><span class="s95oV">)
</span></span><span class="line" line="4"><span emptylineplaceholder="true">
</span></span><span class="line" line="5"><span class="s95oV">fennel.</span><span class="svObZ">path</span><span class="snl16"> =</span><span class="sDLfK"> package.path</span><span class="snl16"> ..</span><span class="sU2Wk"> &quot;;&quot; </span><span class="snl16">..</span><span class="sDLfK"> os.getenv</span><span class="s95oV">(</span><span class="sU2Wk">&quot;HOME&quot;</span><span class="s95oV">) </span><span class="snl16">..</span><span class="sU2Wk"> &quot;/.hammerspoon/?.fnl&quot;
</span></span><span class="line" line="6"><span emptylineplaceholder="true">
</span></span><span class="line" line="7"><span class="sDLfK">table.insert</span><span class="s95oV">(</span><span class="sDLfK">package.loaders</span><span class="snl16"> or</span><span class="sDLfK"> package.searchers</span><span class="s95oV">, fennel.</span><span class="svObZ">searcher</span><span class="s95oV">)
</span></span><span class="line" line="8"><span emptylineplaceholder="true">
</span></span><span class="line" line="9"><span class="sDLfK">require</span><span class="sU2Wk"> &#39;main&#39;
</span></span></code><!--]--></pre><h2 id="translating-lua-to-fennel"><a href="#translating-lua-to-fennel"><!--[-->Translating Lua to Fennel<!--]--></a></h2><p><!--[-->As a Fennel novice, I was happy to see that the Fennel project provides an online
cross-compiler for Lua and Fennel called <a href="https://fennel-lang.org/see" rel="nofollow"><!--[-->anti-fennel<!--]--></a>, and while it can generate some
strange-looking Fennel code, it was an extremely useful tool for me to get
up-and-running right away. For example, by pasting the simple <code><!--[-->sleep<!--]--></code> function
from the <code><!--[-->helpers<!--]--></code> module into the compiler:<!--]--></p><pre class="language-lua shiki shiki-themes github-dark" style=""><!--[--><code><span class="line" line="1"><span class="snl16">function</span><span class="svObZ"> sleep</span><span class="s95oV">(ms)
</span></span><span class="line" line="2"><span class="sDLfK">    os.execute</span><span class="s95oV">(</span><span class="sU2Wk">&quot;sleep &quot; </span><span class="snl16">..</span><span class="sDLfK"> tonumber</span><span class="s95oV">(ms) </span><span class="snl16">/</span><span class="sDLfK"> 1000</span><span class="s95oV">)
</span></span><span class="line" line="3"><span class="snl16">end
</span></span></code><!--]--></pre><pre class="language-lisp shiki shiki-themes github-dark" style=""><!--[--><code><span class="line" line="1"><span class="s95oV">(fn </span><span class="sDLfK">sleep</span><span class="s95oV"> [ms]
</span></span><span class="line" line="2"><span class="s95oV">  (os.execute (.. </span><span class="sU2Wk">&quot;sleep &quot;</span><span class="s95oV"> (</span><span class="sDLfK">/</span><span class="s95oV"> (tonumber ms) </span><span class="sDLfK">1000</span><span class="s95oV">))))
</span></span></code><!--]--></pre><p><!--[-->As another example, here is the output for my <em><!--[-->caffeine<!--]--></em> toggle:<!--]--></p><pre class="language-lua shiki shiki-themes github-dark" style=""><!--[--><code><span class="line" line="1"><span class="s95oV">hs.</span><span class="svObZ">hotkey</span><span class="s95oV">.</span><span class="sDLfK">bind</span><span class="s95oV">(HYPER, </span><span class="sU2Wk">&quot;0&quot;</span><span class="s95oV">, </span><span class="snl16">function</span><span class="s95oV">()
</span></span><span class="line" line="2"><span class="s95oV">  hs.</span><span class="svObZ">caffeinate</span><span class="s95oV">.</span><span class="sDLfK">toggle</span><span class="s95oV">(</span><span class="sU2Wk">&quot;displayIdle&quot;</span><span class="s95oV">)
</span></span><span class="line" line="3"><span class="snl16">  if</span><span class="s95oV"> hs.</span><span class="svObZ">caffeinate</span><span class="s95oV">.</span><span class="sDLfK">get</span><span class="s95oV">(</span><span class="sU2Wk">&quot;displayIdle&quot;</span><span class="s95oV">) </span><span class="snl16">then
</span></span><span class="line" line="4"><span class="svObZ">    helpers</span><span class="s95oV">:</span><span class="sDLfK">show</span><span class="s95oV">(</span><span class="sU2Wk">&quot;Caffeine Enabled&quot;</span><span class="s95oV">, </span><span class="sDLfK">nil</span><span class="s95oV">, helpers.</span><span class="svObZ">styles</span><span class="s95oV">.</span><span class="svObZ">success</span><span class="s95oV">, helpers.</span><span class="svObZ">assets</span><span class="s95oV">.</span><span class="svObZ">check</span><span class="s95oV">)
</span></span><span class="line" line="5"><span class="snl16">  else
</span></span><span class="line" line="6"><span class="svObZ">    helpers</span><span class="s95oV">:</span><span class="sDLfK">show</span><span class="s95oV">(</span><span class="sU2Wk">&quot;Caffeine Disabled&quot;</span><span class="s95oV">, </span><span class="sDLfK">nil</span><span class="s95oV">, helpers.</span><span class="svObZ">styles</span><span class="s95oV">.</span><span class="svObZ">error</span><span class="s95oV">, helpers.</span><span class="svObZ">assets</span><span class="s95oV">.</span><span class="svObZ">ban</span><span class="s95oV">)
</span></span><span class="line" line="7"><span class="snl16">  end
</span></span><span class="line" line="8"><span class="snl16">end</span><span class="s95oV">)
</span></span></code><!--]--></pre><pre class="language-lisp shiki shiki-themes github-dark" style=""><!--[--><code><span class="line" line="1"><span class="s95oV">(hs.hotkey.bind HYPER </span><span class="svObZ">:0
</span></span><span class="line" line="2"><span class="s95oV">  (fn [] (hs.caffeinate.toggle </span><span class="svObZ">:displayIdle</span><span class="s95oV">)
</span></span><span class="line" line="3"><span class="s95oV">    (</span><span class="snl16">if</span><span class="s95oV"> (hs.caffeinate.get </span><span class="svObZ">:displayIdle</span><span class="s95oV">)
</span></span><span class="line" line="4"><span class="s95oV">      (</span><span class="sDLfK">helpers</span><span class="s95oV">:show </span><span class="sU2Wk">&quot;Caffeine Enabled&quot;</span><span class="sDLfK"> nil</span><span class="s95oV"> helpers.styles.success helpers.assets.check)
</span></span><span class="line" line="5"><span class="s95oV">      (</span><span class="sDLfK">helpers</span><span class="s95oV">:show </span><span class="sU2Wk">&quot;Caffeine Disabled&quot;</span><span class="sDLfK"> nil</span><span class="s95oV"> helpers.styles.error helpers.assets.ban))))
</span></span></code><!--]--></pre><p><!--[-->This was especially helpful for more gnarly modules like the <code><!--[-->window<!--]--></code> module used for
window management, and seeing the Lua and Fennel code side-by-side was a kick starter in
learning the language!<!--]--></p><h2 id="next-steps"><a href="#next-steps"><!--[-->Next Steps<!--]--></a></h2><p><!--[-->While my Fennel Hammerspoon configuration now works with parity to its Lua counterpart,
I have not yet added new features or modules. I look forward to writing new Fennel code,
and deepen my understanding of Lisp and the Fennel programming language.<!--]--></p><p><!--[-->Additionally, before beginning this endeavor, I was already aware of projects like
<a href="https://github.com/agzam/spacehammer" rel="nofollow"><!--[-->spacehammer<!--]--></a>; a wildly impressive Hammerspoon configuration written in Fennel, but,
I wanted to start small and learn the integration myself. However, with the basics out
of the way, I hope to explore this project further, and seek lessons-learned for the
configuration of my own.<!--]--></p><p><!--[-->The full pull-request for translating my Lua Hammerspoon configuration to Fennel can be
found here: <a href="https://github.com/cmpadden/dotfiles/pull/19/files" rel="nofollow"><!--[-->https://github.com/cmpadden/dotfiles/pull/19/files<!--]--></a><!--]--></p><style>html pre.shiki code .sAwPA, html code.shiki .sAwPA{--shiki-default:#6A737D}html pre.shiki code .snl16, html code.shiki .snl16{--shiki-default:#F97583}html pre.shiki code .s95oV, html code.shiki .s95oV{--shiki-default:#E1E4E8}html pre.shiki code .sDLfK, html code.shiki .sDLfK{--shiki-default:#79B8FF}html pre.shiki code .sU2Wk, html code.shiki .sU2Wk{--shiki-default:#9ECBFF}html pre.shiki code .svObZ, html code.shiki .svObZ{--shiki-default:#B392F0}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}</style></div></article></div><!--]--></main><footer class="pin-b w-full p-4 text-xs font-bold text-white"><div class="flex justify-center space-x-2"><a class="hover:cursor-pointer hover:text-blue-200" href="https://github.com/cmpadden/cmpadden.github.io"> © Colton Padden</a><span>•</span><a class="hover:cursor-pointer hover:text-blue-200" href="/sitemap.xml">Sitemap</a><span>•</span><a class="hover:cursor-pointer hover:text-blue-200" href="/atom">RSS</a></div></footer></main></div></div></div><div id="teleports"></div><script data-hid=":WFaGyVfuXU:">document.querySelectorAll('[data-prehydrate-id*=":WFaGyVfuXU:"]').forEach(e=>{let t=window._nuxtTimeNow||=Date.now(),n=(e,t)=>t>0?e[0].toUpperCase()+e.slice(1):e,r=new Date(e.getAttribute(`datetime`)),i={};for(let t of e.getAttributeNames())if(t.startsWith(`data-`)){let r=t.slice(5).split(`-`).map(n).join(``);r===`relativeStyle`&&(r=`style`),i[r]=e.getAttribute(t)}if(i.relative){let n=(r.getTime()-t)/1e3,a=[{unit:`second`,seconds:1,threshold:60},{unit:`minute`,seconds:60,threshold:60},{unit:`hour`,seconds:3600,threshold:24},{unit:`day`,seconds:86400,threshold:30},{unit:`month`,seconds:2592e3,threshold:12},{unit:`year`,seconds:31536e3,threshold:1/0}],{unit:o,seconds:s}=a.find(({seconds:e,threshold:t})=>Math.abs(n/e)<t)||a[a.length-1],c=n/s;e.textContent=new Intl.RelativeTimeFormat(i.locale,i).format(Math.round(c),o)}else e.textContent=new Intl.DateTimeFormat(i.locale,i).format(r)})</script><script type="application/json" data-nuxt-data="nuxt-app" data-ssr="true" id="__NUXT_DATA__" data-src="/blog/fennel-initial-exploration/_payload.json?6229f6a7-f2d1-47ee-878b-0340ca0bb70a">[{"state":1,"once":3,"_errors":4,"serverRendered":6,"path":7,"prerenderedAt":8},["Reactive",2],{},["Set"],["ShallowReactive",5],{"/blog/fennel-initial-exploration":-1},true,"/blog/fennel-initial-exploration",1769569020757]</script><script>window.__NUXT__={};window.__NUXT__.config={public:{mdc:{components:{prose:true,map:{}},headings:{anchorLinks:{h1:false,h2:true,h3:true,h4:true,h5:false,h6:false}}},content:{wsUrl:""}},app:{baseURL:"/",buildId:"6229f6a7-f2d1-47ee-878b-0340ca0bb70a",buildAssetsDir:"/_nuxt/",cdnURL:""}}</script></body></html>