{"_path":"/articles/vim-fugitive-gpg-pinentry","_dir":"articles","_draft":false,"_partial":false,"_locale":"","title":"Using pinentry-mac to sign commits from vim-fugitive","description":"In order to sign git commits from within Vim using a plugin like tpope/vim-fugitive, it is necessary to configure the gpg-agent to use a GUI based pinentry-program.","draft":false,"date":"2024-05-11","tags":["vim","tip"],"categories":["tooling","tips"],"excerpt":{"type":"root","children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In order to sign git commits from within Vim using a plugin like "},{"type":"element","tag":"a","props":{"href":"https://github.com/tpope/vim-fugitive","rel":["nofollow"]},"children":[{"type":"text","value":"tpope/vim-fugitive"}]},{"type":"text","value":", it is necessary to configure the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"gpg-agent"}]},{"type":"text","value":" to use a GUI based "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"pinentry-program"}]},{"type":"text","value":"."}]}]},"body":{"type":"root","children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In order to sign git commits from within Vim using a plugin like "},{"type":"element","tag":"a","props":{"href":"https://github.com/tpope/vim-fugitive","rel":["nofollow"]},"children":[{"type":"text","value":"tpope/vim-fugitive"}]},{"type":"text","value":", it is necessary to configure the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"gpg-agent"}]},{"type":"text","value":" to use a GUI based "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"pinentry-program"}]},{"type":"text","value":"."}]},{"type":"element","tag":"h2","props":{"id":"preface"},"children":[{"type":"text","value":"Preface"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The man, the myth, the legend, Timothy Popallopollis himself "},{"type":"element","tag":"a","props":{"href":"https://github.com/tpope/vim-fugitive/issues/846#issuecomment-253816577","rel":["nofollow"]},"children":[{"type":"text","value":"recommends"}]},{"type":"text","value":" configuring your "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"gpg-agent"}]},{"type":"text","value":" to use a GUI based "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"pinentry-program"}]},{"type":"text","value":". On macOS this can be done quite by simply installing "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"pinentry-mac"}]},{"type":"text","value":", and updating your "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"gpg-agent.conf"}]},{"type":"text","value":"."}]},{"type":"element","tag":"h2","props":{"id":"configuration"},"children":[{"type":"text","value":"Configuration"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"First things first, let's install the pinentry program."}]},{"type":"element","tag":"pre","props":{"code":"$ brew install pinentry-mac\n","language":"bash","meta":"","className":"language-bash shiki shiki-themes github-light","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6F42C1"},"children":[{"type":"text","value":"$"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62"},"children":[{"type":"text","value":" brew"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62"},"children":[{"type":"text","value":" install"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62"},"children":[{"type":"text","value":" pinentry-mac\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Then, all we need to do is set the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"pinentry-program"}]},{"type":"text","value":" option in your "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"~/.gnupg/gpg-agent.conf"}]},{"type":"text","value":" file."}]},{"type":"element","tag":"pre","props":{"code":"default-cache-ttl 600\nmax-cache-ttl 7200\npinentry-program /opt/homebrew/bin/pinentry-mac\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"default-cache-ttl 600\nmax-cache-ttl 7200\npinentry-program /opt/homebrew/bin/pinentry-mac\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"If your don't know the path to your pinentry program, you can throw down a quick "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"which"}]},{"type":"text","value":"."}]},{"type":"element","tag":"pre","props":{"code":"$ which pinentry-mac\n/opt/homebrew/bin/pinentry-mac\n","language":"bash","meta":"","className":"language-bash shiki shiki-themes github-light","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6F42C1"},"children":[{"type":"text","value":"$"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62"},"children":[{"type":"text","value":" which"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62"},"children":[{"type":"text","value":" pinentry-mac\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6F42C1"},"children":[{"type":"text","value":"/opt/homebrew/bin/pinentry-mac\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Or use your Homebrew prefix."}]},{"type":"element","tag":"pre","props":{"code":"$ echo $(brew --prefix)/bin/pinentry-mac\n/opt/homebrew/bin/pinentry-mac\n","language":"bash","meta":"","className":"language-bash shiki shiki-themes github-light","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6F42C1"},"children":[{"type":"text","value":"$"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62"},"children":[{"type":"text","value":" echo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E"},"children":[{"type":"text","value":" $("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#6F42C1"},"children":[{"type":"text","value":"brew"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#005CC5"},"children":[{"type":"text","value":" --prefix"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62"},"children":[{"type":"text","value":"/bin/pinentry-mac\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6F42C1"},"children":[{"type":"text","value":"/opt/homebrew/bin/pinentry-mac\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"But that's all it takes. Now, you should be prompted to enter your gpg pin in an external window when signing commits from vim."}]},{"type":"element","tag":"style","props":{},"children":[{"type":"text","value":"html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"preface","depth":2,"text":"Preface"},{"id":"configuration","depth":2,"text":"Configuration"}]}},"_type":"markdown","_id":"content:articles:vim-fugitive-gpg-pinentry.md","_source":"content","_file":"articles/vim-fugitive-gpg-pinentry.md","_extension":"md"}