{"_path":"/articles/apu2-firmware-upgrade","_dir":"articles","_draft":false,"_partial":false,"_locale":"","title":"Upgrading the Firmware on the PCEngines APU2","description":"I've had a PCEngines APU2 gathering dust for a\nfew years, and have recently decided to dust it off.","date":"2019-12-21","draft":false,"tags":["pcengine","apu"],"categories":["linux"],"excerpt":{"type":"root","children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"I've had a "},{"type":"element","tag":"a","props":{"href":"https://pcengines.ch/apu2.htm","rel":["nofollow"]},"children":[{"type":"text","value":"PCEngines APU2"}]},{"type":"text","value":" gathering dust for a\nfew years, and have recently decided to dust it off."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Since the last time the device has been powered on, there have been many great\nimprovements to the firmware, and it was very-much due for an upgrade. The\nfollowing steps outline how the firmware was upgraded on the APU from the\nalready-installed operating system -- CentOS."}]}]},"body":{"type":"root","children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"I've had a "},{"type":"element","tag":"a","props":{"href":"https://pcengines.ch/apu2.htm","rel":["nofollow"]},"children":[{"type":"text","value":"PCEngines APU2"}]},{"type":"text","value":" gathering dust for a\nfew years, and have recently decided to dust it off."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Since the last time the device has been powered on, there have been many great\nimprovements to the firmware, and it was very-much due for an upgrade. The\nfollowing steps outline how the firmware was upgraded on the APU from the\nalready-installed operating system -- CentOS."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"First, we will connect to the device over the serial port"}]},{"type":"element","tag":"pre","props":{"code":"screen /dev/tty.usbserial 115200\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"screen /dev/tty.usbserial 115200\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Then, we will install the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"flashrom"}]},{"type":"text","value":" utility that is needed to update the\nfirmware. Because it is not available in the default "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"yum"}]},{"type":"text","value":" repositories, we\nwill enable the "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"Extra Packages for Enterprise Linux"}]},{"type":"text","value":" (EPEL) repository before\ninstallation."}]},{"type":"element","tag":"pre","props":{"code":"sudo yum install epel-release\nsudo yum install flashrom\n","language":"bash","meta":"","className":"language-bash shiki shiki-themes github-light","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6F42C1"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62"},"children":[{"type":"text","value":" yum"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62"},"children":[{"type":"text","value":" install"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62"},"children":[{"type":"text","value":" epel-release\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6F42C1"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62"},"children":[{"type":"text","value":" yum"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62"},"children":[{"type":"text","value":" install"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62"},"children":[{"type":"text","value":" flashrom\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Next, we will download the latest version of the firmware that is compatible\nwith the APU2 device from the PC Engines release website:\n"},{"type":"element","tag":"a","props":{"href":"https://pcengines.github.io/","rel":["nofollow"]},"children":[{"type":"text","value":"https://pcengines.github.io/"}]},{"type":"text","value":"."}]},{"type":"element","tag":"pre","props":{"code":"curl -O https://3mdeb.com/open-source-firmware/pcengines/apu2/apu2_v4.11.0.1.rom\n","language":"bash","meta":"","className":"language-bash shiki shiki-themes github-light","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6F42C1"},"children":[{"type":"text","value":"curl"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#005CC5"},"children":[{"type":"text","value":" -O"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62"},"children":[{"type":"text","value":" https://3mdeb.com/open-source-firmware/pcengines/apu2/apu2_v4.11.0.1.rom\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"And finally, we will flash the firmware..."}]},{"type":"element","tag":"pre","props":{"code":"sudo flashrom -w apu2_v4.11.0.1.rom -p internal:boardmismatch=force\n","language":"bash","meta":"","className":"language-bash shiki shiki-themes github-light","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6F42C1"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62"},"children":[{"type":"text","value":" flashrom"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#005CC5"},"children":[{"type":"text","value":" -w"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62"},"children":[{"type":"text","value":" apu2_v4.11.0.1.rom"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#005CC5"},"children":[{"type":"text","value":" -p"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62"},"children":[{"type":"text","value":" internal:boardmismatch=force\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"References:"}]}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://pcengines.ch/apu2.htm","rel":["nofollow"]},"children":[{"type":"text","value":"https://pcengines.ch/apu2.htm"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://pcengines.github.io/","rel":["nofollow"]},"children":[{"type":"text","value":"https://pcengines.github.io/"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://github.com/pcengines/apu2-documentation/blob/master/docs/firmware_flashing.md","rel":["nofollow"]},"children":[{"type":"text","value":"https://github.com/pcengines/apu2-documentation/blob/master/docs/firmware_flashing.md"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://github.com/pcengines/apu2-documentation/blob/master/docs/cold_reset.md","rel":["nofollow"]},"children":[{"type":"text","value":"https://github.com/pcengines/apu2-documentation/blob/master/docs/cold_reset.md"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://github.com/elad/openbsd-apu2","rel":["nofollow"]},"children":[{"type":"text","value":"https://github.com/elad/openbsd-apu2"}]}]}]},{"type":"element","tag":"style","props":{},"children":[{"type":"text","value":"html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[]}},"_type":"markdown","_id":"content:articles:apu2-firmware-upgrade.md","_source":"content","_file":"articles/apu2-firmware-upgrade.md","_stem":"articles/apu2-firmware-upgrade","_extension":"md"}